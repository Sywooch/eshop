$(document).ready(function(){var b="snippets/process.php";function a(d){if(d.count){$("#cart-count").text(d.count)}if(d.sum){$("#cart-sum").text(d.sum)}}function c(d){return parseInt(d.attr("id").replace(/[^\d]+/,""))}$('button[type="button"]').click(function(d){d.preventDefault()});$("#promo-code-wrapper button").click(function(){$this=$(this).prev();$("#cart-item-promocode").next().remove();$.post(b,{action:"a",promocode:$.trim($("#cart-item-promocode").val())},function(e,f,d){if(f=="success"&&e.status==1){$this.removeClass("has-error").addClass("has-success");$("#cart-item-promocode").after('<span class="glyphicon glyphicon-ok form-control-feedback"></span>')}else{$this.removeClass("has-success").addClass("has-error");$("#cart-item-promocode").after('<span class="glyphicon glyphicon-remove form-control-feedback"></span>')}},"json")});$("#push-to-cart").click(function(){var d=$.trim($("#cart-item-amount").val());$.post(b,{action:"b",item_id:parseInt($("#item_id").val()),size:$.trim($("#cart-item-size option:selected").val()),amount:d,inscription:$.trim($("#cart-item-inscription").val()),printpromolink:$("#cart-item-printpromolink").prop("checked")+0,promocode:$.trim($("#cart-item-promocode").val())},function(f,g,e){if(g=="success"&&f.status==1){$("#modalCart .alert-success").html('Вы добавили футболок: <span class="amount badge">'+d+"</span>.");$("#modalCart .var-error").hide();$("#modalCart .var-success").show();a(f)}else{if(f.reason=="size"){$("#modalCart .alert-danger").html("Вы не выбрали размер.")}else{if(f.reason=="amount"){$("#modalCart .alert-danger").html("Вы не указали количество.")}}$("#modalCart .var-success").hide();$("#modalCart .var-error").show()}$("#modalCart").modal()},"json")});$('button[id^="item-id-"]').click(function(){$.post(b,{action:"c",item_id:c($(this))},function(e,f,d){if(f=="success"&&e.status==1){$("#modalCart .alert-success").html('Вы положили <span class="badge">1</span> футболку в Вашу корзину.');$("#modalCart .var-error").hide();$("#modalCart .var-success").show();a(e)}else{$("#modalCart .var-success").hide();$("#modalCart .var-error").show()}$("#modalCart").modal()},"json")});$("#blueimp-gallery").on("slide",function(f,e,d){$(".add-to-cart").unbind().click(function(){var g=$(this).parents(".modal-content").find("img").attr("src").match(/\?(\d+)$/)[1];$.post(b,{action:"c",item_id:g},function(i,j,h){if(j=="success"&&i.status==1){$("#modalCart .alert-success").html('Вы положили <span class="badge">1</span> футболку в Вашу корзину.');$("#modalCart .var-error").hide();$("#modalCart .var-success").show();a(i)}else{$("#modalCart .var-success").hide();$("#modalCart .var-error").show()}$("#modalCart").css({"z-index":$("#blueimp-gallery").css("z-index")+1});$("#modalCart").modal()},"json")})});$('button[id^="cart-id-"]').click(function(){$this=$(this);$.post(b,{action:"d",id:c($(this))},function(e,f,d){if(f=="success"&&e.status==1){if(e.count>0){$this.parents("tr:first").remove();a(e);$("#cart-total").text(e.total)}else{$("#cart-wrapper").remove();$(".alert-info").show()}if(e.count<5){$("#back-to-top").parent().remove()}}},"json")});$('button[id^="cart-idu-"]').click(function(){var d=c($(this));$.post(b,{action:"e",id:d,size:$.trim($("#cart-item-size-"+d+" option:selected").val()),amount:$.trim($("#cart-item-amount-"+d).val()),printpromolink:$("#cart-item-printpromolink-"+d).prop("checked")+0,},function(f,g,e){if(g=="success"&&f.status==1){$("#cart-item-price-"+d).find("span").remove();if($("#cart-item-printpromolink-"+d).prop("checked")){$("#cart-item-price-"+d).append('<span class="small label label-default">-10%</span>')}a(f);$("#cart-item-price-amount-"+d+"").text(f.priceamount);$("#cart-total").text(f.total)}},"json")});$('td[id^="cart-inscription-"] a').click(function(d){d.preventDefault();var e=c($(this).parents("td:first"));$("#modalCartItem").modal().one("shown.bs.modal",function(f){$("textarea",$(this)).val($.trim($("#cart-inscription-"+e+" div:first").text()))}).one("hide.bs.modal",function(g){var f=$.trim($("textarea",$(this)).val());$.post(b,{action:"f",id:e,inscription:f},function(i,j,h){if(j=="success"&&i.status==1){$("#cart-inscription-"+e+" div:first").text(f)}},"json")})})});